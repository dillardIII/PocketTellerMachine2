# === FILE: main.py ===
# ðŸš€ ENEMY UPDATED MAIN â€“ FULL EMPIRE LAUNCHER (Superforged + Immortalized)

import threading
import time

# Core Empire Modules
from ghostforge_core import start_ghostforge
from reflex_engine import start_reflex_engine
from sweep_handler import start_sweep_loop
from auto_repair_engine import run_auto_repair
from bridge_team_launcher import start_bridge_team

print("[PTM] ðŸš€ Launching FULL EMPIRE STACK...")

# Start GhostForge
ghostforge_thread = threading.Thread(target=start_ghostforge)
ghostforge_thread.start()

# Start ReflexEngine
reflex_thread = threading.Thread(target=start_reflex_engine)
reflex_thread.start()

# Start Sweep Handler
sweep_thread = threading.Thread(target=start_sweep_loop)
sweep_thread.start()

# Start Auto Repair Engine
repair_thread = threading.Thread(target=run_auto_repair)
repair_thread.start()

# Start Bridge Team
bridge_thread = threading.Thread(target=start_bridge_team)
bridge_thread.start()

# Keep main process alive
try:
    while True:
        time.sleep(10)
except KeyboardInterrupt:
    print("\n[PTM] â›” Shutting down all systems...")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
from reflex_engine import ReflexEngine
from command_listener import CommandListener
from sweep_handler import SweepHandler
from agents.bridge_team_launcher import start_bridge_team
from file_exec_engine import start_exec_engine
from loop_monitor import monitor_loop_health
from ghostforge_writer import ghostforge_loop
from autonomous_trade_executor import run_autonomous_trading
from meta_dispatcher import MetaDispatcher
from skypiea_node import run_skypiea_loop
from neural_predictor import neural_predictor_loop
from high_risk_manager import run_high_risk_loop

# New Apex Empire Brain
from quantum_brain import quantum_brain_loop
from ghost_memory_matrix import ghost_matrix_loop
from hyperforge_pipeline import hyperforge_loop

threads = []

print("[PTM EMPIRE] ðŸš€ Launching ENEMY UPDATED SUPERFORGED STACK...")

# === Start Reflex Engine
reflex = ReflexEngine()
print("[ReflexEngine] ðŸ§  Initialized Reflex AI Engine")

# === Start Command Listener
listener = CommandListener()
listener.start()
threads.append(listener)
print("[CommandListener] ðŸŽ§ Listening for commands...")

# === Start Sweep Handler
sweeper = SweepHandler()
sweeper.start()
threads.append(sweeper)
print("[SweepHandler] ðŸ§¹ Monitoring system...")

# === Start Bridge Team
print("[BridgeTeam] ðŸ”— Deploying bridge bots...")
start_bridge_team()

# === Helper function
def start_thread(target, name):
    t = threading.Thread(target=target, name=name, daemon=True)
    t.start()
    threads.append(t)

# === Start all empire systems
start_thread(start_exec_engine, "FileExecEngine")
start_thread(monitor_loop_health, "LoopMonitor")
start_thread(ghostforge_loop, "GhostForgeWriter")
start_thread(run_autonomous_trading, "AutoTrader")
start_thread(run_skypiea_loop, "SkypieaNode")
start_thread(neural_predictor_loop, "NeuralPredictor")
start_thread(run_high_risk_loop, "HighRiskManager")

# === Start Empire Brain modules
start_thread(quantum_brain_loop, "QuantumBrain")
start_thread(ghost_matrix_loop, "GhostMatrix")
start_thread(hyperforge_loop, "HyperForge")

# === Meta Dispatcher
dispatcher = MetaDispatcher()
t = threading.Thread(target=dispatcher.start_task_monitor, name="MetaDispatcher", args=(30,), daemon=True)
t.start()
threads.append(t)

# === Empire heartbeat
try:
    while True:
        time.sleep(10)
        print("[PTM EMPIRE] ðŸ’“ Main heartbeat â€“ all empire systems alive, hunting enemies.")
except KeyboardInterrupt:
    print("\n[PTM EMPIRE] â›” Shutting down empire...")